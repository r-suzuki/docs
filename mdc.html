<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Ryota Suzuki (Ef-prime, Inc.) suzuki@ef-prime.com" />
  <title>Measuring distance and correlation between random variables of any type</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Measuring distance and correlation between random
variables of any type</h1>
<p class="author">Ryota Suzuki (Ef-prime, Inc.) suzuki@ef-prime.com</p>
<p class="date">First published on March 25, 2025</p>
</header>
<h1 id="abstract">Abstract</h1>
<p>This paper proposes a measure for assessing the distance between
random variables of any type: continuous, discrete, or a mix of both. In
conjunction with this measure, another generalization of the correlation
coefficient is derived.</p>
<p><strong>Normalized sine distance (NSD)</strong> is a real-valued
measure taking values in the interval <span
class="math inline">\([0,1]\)</span>. It evaluates the closeness of
random variables, by reflecting both linear and nonlinear
relationships.</p>
<p><strong>Generalized absolute correlation coefficient (GACC)</strong>
is naturally derived from NSD. It will be shown that, if the joint
distribution is bivariate normal, it theoretically coincides with the
absolute value of the correlation coefficient.</p>
<p>Under certain conditions, NSD satisfies the axioms of metrics,
suggesting its potential applications in cluster analysis and
multidimensional scaling. In addition to its use in exploratory data
analysis, GACC is also expected to have applications in multivariate
analysis.</p>
<p><strong>Note that this is a preliminary draft subject to corrections,
as well as modifications to the definitions of terminology as further
progress is made. The latest version is available at <a
href="https://github.com/r-suzuki/preprints"
class="uri">https://github.com/r-suzuki/preprints</a>.</strong></p>
<h1 id="概要">概要</h1>
<p>本稿では任意の型（連続、離散またはその混合）の確率変数間の距離を測る尺度を提案し、あわせて一般化された相関係数の定義を新たに導出する。</p>
<p><strong>基準化正弦距離</strong> は<span
class="math inline">\([0,1]\)</span>に値をとる実数値で、線形および非線形の関係も反映して確率変数の近さを評価する。これを用いて
<strong>一般化相関係数</strong>
が自然に導出され、同時分布が2変量正規分布の場合、相関係数の絶対値と理論的に一致することが示される。</p>
<p>基準化正弦距離は一定の条件のもとで距離の公理を満たし、クラスター分析や多次元尺度法への応用が想定される。一般化相関係数は探索的データ解析における利用のほか、同様に多変量解析への応用についても期待される。</p>
<p>本稿では基本的な構想を提示し、理論的考察を中心に議論を展開する。推定手法の開発や数値実験等については現在進行中であり、今後さらなる検証を行う予定である。</p>
<p><strong>なお本稿は草稿段階であり、今後の進捗に応じて誤りの訂正、用語の変更などが生じる可能性があることに注意されたい。最新版は以下にて公開されている：<a
href="https://github.com/r-suzuki/preprints"
class="uri">https://github.com/r-suzuki/preprints</a></strong></p>
<h1 id="前提">前提</h1>
<p>確率変数<span
class="math inline">\(x,y\)</span>について考える。以下の議論は原則として<span
class="math inline">\(x,y\)</span>が連続または離散（あるいはその混合）のいずれも対象とするが、記法の簡便のため基本的には連続確率変数を想定して記述する。</p>
<p>同時密度関数を<span
class="math inline">\(f(x,y)\)</span>、周辺密度関数を<span
class="math inline">\(f(x),f(y)\)</span>で表す。積分においては周辺密度が正となる領域のみを考える。</p>
<p>特に離散確率変数であることを明示する場合、同時確率関数を<span
class="math inline">\(p(x,y)\)</span>、周辺確率関数を<span
class="math inline">\(p(x),p(y)\)</span>で表す。連続の場合と同様に、周辺確率が正となる集合のみを考える。</p>
<h1 id="関連性スコアの解釈">関連性スコアの解釈</h1>
<p>連続または離散、あるいはその混合を含む任意の確率変数<span
class="math inline">\(x,y\)</span>について、その関係の強さを測る指標が提案された[1]：
<span class="math display">\[
\phi = E \bigg(\frac{f(x,y)}{f(x)f(y)}\bigg)
\]</span> ここで<span class="math inline">\(1 \leq \phi \leq
\infty\)</span>であり、<span class="math inline">\(x\)</span>と<span
class="math inline">\(y\)</span>が独立のとき最小値<span
class="math inline">\(1\)</span>をとる。本稿ではこれを
<strong>関連性スコア（association score）</strong> と呼ぶ。</p>
<p>逆数をとると<span class="math inline">\(0 \leq \phi^{-1} \leq
1\)</span>となり、確率変数間の近さを測る一種の非類似度といえる。本稿ではこれを
<strong>独立性スコア（independency score）</strong> と呼ぶ。</p>
<p>ここで<span
class="math inline">\(\phi\)</span>について以下のように展開することができる：
<span class="math display">\[
\begin{align*}
\phi &amp;= E \bigg(\frac{f(x,y)}{f(x)f(y)}\bigg) \\
&amp;= \int_x \int_y \frac{f(x,y)}{f(x)f(y)} f(x,y) dxdy \\
&amp;= \int_x \int_y \frac{f(x,y)}{f(y)} \frac{f(x,y)}{f(x)} dxdy \\
&amp;= \int_x \int_y f(x|y)f(y|x) dxdy \\
\end{align*}
\]</span> これは<span
class="math inline">\(L^2\)</span>空間における、条件付き分布<span
class="math inline">\(f(x|y),f(y|x)\)</span>の内積を定める形と解釈することができる。この値について、いわゆるコサイン類似度[2]としての利用を想定して議論を進める。</p>
<p>結果的には異なるアプローチが必要になるものの、おおむね狙い通りの結果が示される。</p>
<h1 id="離散の場合">離散の場合</h1>
<p>まず離散集合に値をとる確率変数について考える。簡単のため<span
class="math inline">\(x,y\)</span>がともに離散確率変数とすると、関連性スコアは以下の形をとる：
<span class="math display">\[
\begin{align*}
\phi &amp;= E \bigg(\frac{p(x,y)}{p(x)p(y)}\bigg) \\
&amp;= \sum_x \sum_y \frac{p(x,y)}{p(x)p(y)} p(x,y) \\
&amp;= \sum_x \sum_y \frac{p(x,y)}{p(y)} \frac{p(x,y)}{p(x)}  \\
&amp;= \sum_x \sum_y p(x|y)p(y|x) \\
\end{align*}
\]</span> ここで明瞭性のため以下のように書き換える： <span
class="math display">\[
\begin{align*}
q_x &amp;= p(x|y) \\
r_y &amp;= p(y|x) \\
\end{align*}
\]</span> <span
class="math inline">\(L^2\)</span>空間における内積とノルムは以下で定められる：
<span class="math display">\[
\begin{align*}
\langle q, r \rangle &amp;= \sum \sum q_x r_y &amp;&amp;= \phi \in
[1,\min\{k_x, k_y\}]\\
\|q\| &amp;= \sqrt{\sum \sum q_x^2} &amp;&amp;= \sqrt{k_x}\\
\|r\| &amp;= \sqrt{\sum \sum r_y^2} &amp;&amp;= \sqrt{k_y}
\end{align*}
\]</span> ここで<span class="math inline">\(k_x, k_y\)</span>は<span
class="math inline">\(x,y\)</span>それぞれの定義域の基数である。ここから以下のように角度<span
class="math inline">\(\theta^*\)</span>が定まる： <span
class="math display">\[
\begin{align*}
\cos \theta^* &amp;= \frac{\langle q, r\rangle}{\|q\|\|r\|}\\
&amp;= \frac{\phi}{\sqrt{k_x k_y}}
\end{align*}
\]</span> ここで<span
class="math inline">\(k=\max\{k_x,k_y\}\)</span>とすると分子は<span
class="math inline">\([1,k]\)</span>に値をとることから、<span
class="math inline">\(1/k \leq \cos \theta^* \leq
1\)</span>がいえる。無限離散集合に値をとる場合においても、<span
class="math inline">\(k \to \infty\)</span>のもとで<span
class="math inline">\(0 \leq \cos \theta^* \leq 1\)</span>がわかる。</p>
<h1 id="連続の場合">連続の場合</h1>
<p>続いて連続確率変数について考える。簡単のため<span
class="math inline">\(x,y\)</span>がともに連続確率変数とする。先に述べた通り、関連性スコアは以下の形をとる：
<span class="math display">\[
\begin{align*}
\phi &amp;= E \bigg(\frac{f(x,y)}{f(x)f(y)}\bigg) \\
&amp;= \int_x \int_y f(x|y)f(y|x) dxdy \\
\end{align*}
\]</span> ここで明瞭性のため以下のように書き換える： <span
class="math display">\[
\begin{align*}
g_x &amp;= f(x|y)\\
h_y &amp;= f(y|x)
\end{align*}
\]</span> <span
class="math inline">\(L^2\)</span>空間における内積とノルムは以下で定められる：
<span class="math display">\[
\begin{align*}
\langle g, h \rangle &amp;= \iint gh\\
\|g\| &amp;= \sqrt{\iint g^2} &amp; \\
\|h\| &amp;= \sqrt{\iint h^2} &amp; \\
\end{align*}
\]</span> ここから以下のように角度<span
class="math inline">\(\theta^*\)</span>が定まる： <span
class="math display">\[
\begin{align*}
\cos \theta^* &amp;= \frac{\langle g, h\rangle}{\|g\|\|h\|} \\
&amp;\propto \phi
\end{align*}
\]</span></p>
<p>ここで条件付き密度関数<span
class="math inline">\(g,h\)</span>に替えてその平方根をとれば、Bhattacharyya係数に相当する式が得られる[3]。しかしここではそのような変形を行わず、もとの<span
class="math inline">\(\phi\)</span>の定義のまま議論を進めたい。</p>
<h1 id="角度の導出">角度の導出</h1>
<p>あらためて<span class="math inline">\(\phi\)</span>について、<span
class="math inline">\(0 \leq \phi^{-1} \leq
1\)</span>となる。また[1]において定義されたように <span
class="math display">\[
|r| = \sqrt{1-\phi^{-1}}
\]</span> についても（当然ながら）<span class="math inline">\(0 \leq |r|
\leq 1\)</span>となる。ここから<span class="math inline">\(0 \leq \theta
\leq \pi/2\)</span>を適当にとれば <span class="math display">\[
\begin{align*}
\cos \theta &amp;= \sqrt{1-\phi^{-1}}\\
\sin \theta &amp;= \sqrt{\phi^{-1}}
\end{align*}
\]</span>
と（少なくとも表面的には）定義することができる。実際この定義において以下が成り立つ：
<span class="math display">\[
\cos^2 \theta + \sin^2 \theta = (1-\phi^{-1} + \phi^{-1}) = 1
\]</span></p>
<p>もしこのような解釈が成り立つのであれば、<span
class="math inline">\(\sin \theta = 0\)</span>は<span
class="math inline">\(\phi^{-1} =
0\)</span>と同値であり、2次元正規分布における相関係数<span
class="math inline">\(\rho = 1\)</span>に対応する。同様に<span
class="math inline">\(\sin \theta = 1\)</span>は<span
class="math inline">\(\phi^{-1} =
1\)</span>を意味し、2次元正規分布における相関係数<span
class="math inline">\(\rho = 0\)</span>に対応する。</p>
<p>すなわち（少なくとも連続分布においては）完全な相関のとき<span
class="math inline">\(0\)</span>、完全な無相関のとき<span
class="math inline">\(1\)</span>となり、<span
class="math inline">\([0,1]\)</span>に値をとる。これは理解しやすいうえ、非類似度として理論的にも望ましい性質といえる。したがって以降では、このような<span
class="math inline">\(\theta\)</span>が存在することを確かめることにする。</p>
<h1 id="連続の場合-1">連続の場合</h1>
<p>引き続き連続確率変数について議論する。<span
class="math inline">\(\phi\)</span>に関連した角度<span
class="math inline">\(\theta\)</span>があり、<span
class="math inline">\(0 \leq \theta \leq
\pi/2\)</span>であると仮定する。</p>
<p>このように定めた<span
class="math inline">\(\theta\)</span>が一意に存在するかどうかを調べる。いま<span
class="math inline">\(\sin^2 \theta =
\phi^{-1}\)</span>を仮定すると<span class="math inline">\(\sin \theta =
\sqrt{\phi^{-1}}\)</span>であるから、<span
class="math inline">\(\theta\)</span>を以下で定めたい： <span
class="math display">\[
\theta = \arcsin \sqrt{\phi^{-1}}
\]</span> ここで<span
class="math inline">\(\arcsin\)</span>の定義域を考えると、<span
class="math inline">\(\sqrt{\phi^{-1}}\)</span>が<span
class="math inline">\([-1,1]\)</span>の範囲に収まっている必要がある。先に述べたように<span
class="math inline">\(0 \leq \phi^{-1} \leq
1\)</span>であることが保証されているので、<span
class="math inline">\(\sqrt{\phi^{-1}} \in
[0,1]\)</span>である。またこのとき<span
class="math inline">\(\arcsin\)</span>の値域は<span
class="math inline">\([0,\pi/2]\)</span>であるから、仮定<span
class="math inline">\(0 \leq \theta \leq
\pi/2\)</span>とも合致する。</p>
<p>したがってこのような<span
class="math inline">\(\theta\)</span>が定まり、このとき<span
class="math inline">\(\cos \theta =
\sqrt{1-\phi^{-1}}\)</span>となる。</p>
<p>整理すると <span class="math display">\[
\begin{align*}
\cos \theta &amp;= \sqrt{1-\phi^{-1}} \\
\sin \theta &amp;= \sqrt{\phi^{-1}}
\end{align*}
\]</span> となる。ここで<span class="math inline">\(0 \leq \phi^{-1}
\leq 1\)</span>であり、<span
class="math inline">\(x,y\)</span>が独立のとき<span
class="math inline">\(1\)</span>、互いに「完全に予測する」とき<span
class="math inline">\(0\)</span>であった[1]。ゆえに<span
class="math inline">\(\cos \theta\)</span>を類似度、<span
class="math inline">\(\sin
\theta\)</span>を非類似度と解釈することができる。</p>
<h1 id="離散の場合-1">離散の場合</h1>
<p>以上の議論から、離散確率変数についても<span
class="math inline">\(\theta^*\)</span>ではなく<span
class="math inline">\(\theta\)</span>に関して角度を求めることにする。すなわち連続の場合と同様に
<span class="math display">\[
\begin{align*}
\cos \theta &amp;= \sqrt{1-\phi^{-1}} \\
\sin \theta &amp;= \sqrt{\phi^{-1}}
\end{align*}
\]</span> とおく。</p>
<p>このとき確率変数<span
class="math inline">\(x,y\)</span>の定義域の基数を<span
class="math inline">\(k_x, k_y\)</span>とすると、<span
class="math inline">\(k=\min\{k_x,k_y\}\)</span>に対して<span
class="math inline">\(1/\sqrt{k} \leq \sqrt{\phi^{-1}} \leq
1\)</span>となる。</p>
<p>すなわち離散確率変数においては、定義域の基数<span
class="math inline">\(k\)</span>によって<span
class="math inline">\(\theta\)</span>の取りうる値の範囲が<span
class="math inline">\(1/\sqrt{k}\)</span>以上に制限されてしまう。</p>
<p>そこで、<span class="math inline">\(\sqrt{\phi^{-1}} = \sin \theta =
1/\sqrt{k}\)</span>のとき<span class="math inline">\(\sin \theta&#39; =
0\)</span>となるように基準化する。すなわち角度を「拡大」することを考える。</p>
<p>まず<span class="math inline">\(\theta\)</span>の<span
class="math inline">\(\pi/2\)</span>に対する余角<span
class="math inline">\(\eta\)</span>をとって<span class="math inline">\(0
\leq \eta \leq (1 - 1/\sqrt{k})\)</span>とする。これを<span
class="math inline">\(\eta\)</span>の上限を用いて基準化し（線形正規化）、ふたたび余角をとったものが求める<span
class="math inline">\(\theta&#39;\)</span>である。すなわち <span
class="math display">\[
\begin{align*}
\eta &amp;= \pi / 2 - \theta \\
\eta&#39; &amp;= \frac{\eta - 1/\sqrt{k}}{1 - 1/\sqrt{k}} \\
\theta&#39; &amp;= \pi/2 - \eta&#39;
\end{align*}
\]</span> である。最終的に必要な<span class="math inline">\(\sin
\theta&#39;\)</span>はこれを逆に辿ればよいが、 <span
class="math display">\[
\begin{align*}
\sin \theta&#39; &amp;= \sin \big(\pi/2 - \eta&#39;\big) \\
&amp;= \cos \eta&#39; \\
&amp;= \cos \frac{\eta - 1/\sqrt{k}}{1 - 1/\sqrt{k}}\\
\end{align*}
\]</span>
となり容易には解けない。そこで定義通りに角度を求めることにする。つまり
<span class="math display">\[
\begin{align*}
\cos \eta &amp;= \cos \big(\pi/2 - \theta \big)\\
&amp;= \sin \theta = \sqrt{\phi^{-1}} \\
\eta &amp;= \arccos \sqrt{\phi^{-1}}
\end{align*}
\]</span> とし、ここから <span class="math display">\[
\begin{align*}
\eta&#39; &amp;= \frac{\eta - 1/\sqrt{k}}{1 - 1/\sqrt{k}} \\
\theta&#39; &amp;= \pi/2 - \eta&#39;
\end{align*}
\]</span> とする。ここで<span class="math inline">\(\sin
\theta&#39;\)</span>は <span class="math display">\[
\begin{align*}
\sin \theta&#39; &amp;= \sin \big( \pi/2 - \eta&#39; \big)\\
&amp;= \cos \eta&#39;
\end{align*}
\]</span> であるから、まとめると <span class="math display">\[
\sin \theta&#39; = \cos \bigg( \frac{\arccos \sqrt{\phi^{-1}} -
1/\sqrt{k}}{1 - 1/\sqrt{k}}\bigg)
\]</span> となる。実際<span class="math inline">\(k \to
\infty\)</span>のとき <span class="math display">\[
\begin{align*}
\sin \theta&#39; &amp;= \cos \big(\arccos \sqrt{\phi^{-1}}\big) \\
&amp;= \sqrt{\phi^{-1}} \\
&amp;= \sin \theta
\end{align*}
\]</span> が確かめられる。</p>
<h1 id="確率変数間の距離">確率変数間の距離</h1>
<p>以上の議論から、基準化された角度<span
class="math inline">\(\theta&#39; \in
[0,\pi/2]\)</span>を定めることによって
<strong>基準化正弦非類似度（normalized sine dissimilarity）</strong>
を得ることができた： <span class="math display">\[
\begin{align*}
d(x,y) &amp;= \sin \theta&#39; \\
&amp;= \cos \bigg( \frac{\arccos \sqrt{\phi^{-1}} - 1/\sqrt{k}}{1 -
1/\sqrt{k}}\bigg)
\end{align*}
\]</span> ここで<span class="math inline">\(k\)</span>は確率変数<span
class="math inline">\(x,y\)</span>の定義域の基数<span
class="math inline">\(k_x, k_y\)</span>のうち小さいほう、すなわち<span
class="math inline">\(k=\min\{k_x,k_y\}\)</span>である。</p>
<p><span
class="math inline">\(x,y\)</span>の定義域がいずれも無限集合の場合は基準化が不要で、単に
<span class="math display">\[
d(x,y) = \sin \theta = \sqrt{\phi^{-1}}
\]</span> としてよい。実際これは先の定義で<span class="math inline">\(k
\to \infty\)</span>としたときの極限と一致する。</p>
<p>ここで<span class="math inline">\(0 \leq \theta&#39; \leq
\pi/2\)</span>であることから、これは三角不等式を満たす。また対称性も持つことから、<span
class="math inline">\(d(x,y) = 0\)</span>となる<span
class="math inline">\(x,y\)</span>を同値類にまとめることにすれば、これは距離の公理を満たすことがわかる。したがってこれを
<strong>基準化正弦距離（normalized sine distance; NSD）</strong>
と呼ぶことにする。</p>
<p>また<span class="math inline">\(m\)</span>個の確率変数の組<span
class="math inline">\(\mathbf{x} = (x_1, x_2, \cdots,
x_m)\)</span>について、<span class="math inline">\(d_{ij} = d(x_i,
x_j)\)</span>と表記することにする。このとき
<strong>基準化正弦距離行列（normalized sine distance matrix）</strong>
を <span class="math display">\[
(\mathbf{D})_{ij} = d_{ij}
\]</span> なる<span
class="math inline">\(m\)</span>次元正方行列と定義する。定義より対角成分は<span
class="math inline">\((\mathbf{D})_{ii} =
0\)</span>であり、また対称行列である。</p>
<h1 id="相関係数との関係">相関係数との関係</h1>
<p>[1]において、相関係数<span
class="math inline">\(\rho\)</span>をもつ2次元正規分布において<span
class="math inline">\(|\rho| =
\sqrt{1-\phi^{-1}}\)</span>という関係があることが示された。</p>
<p>これは本稿における<span class="math inline">\(\cos
\theta\)</span>にあたるので、離散確率変数も含む一般の場合について
<strong>一般化絶対相関係数（generalized absolute correlation
coefficient; GACC）</strong> または省略して
<strong>一般化相関係数（generalized correlation coefficient）</strong>
を <span class="math display">\[
|r| = \sin \bigg( \frac{\arccos \sqrt{\phi^{-1}} - 1/\sqrt{k}}{1 -
1/\sqrt{k}}\bigg)
\]</span> と定義することができる。ここで<span
class="math inline">\(k\)</span>は確率変数<span
class="math inline">\(x,y\)</span>の定義域の基数<span
class="math inline">\(k_x, k_y\)</span>のうち小さいほう、すなわち<span
class="math inline">\(k=\min\{k_x,k_y\}\)</span>で、<span
class="math inline">\(k \to \infty\)</span>に対して <span
class="math display">\[
\begin{align*}
|r| &amp;= \sin \big( \arccos \sqrt{\phi^{-1}}\big) \\
&amp;= \sin \bigg( \frac{\pi}{2} - \theta \bigg) \\
&amp;= \cos \theta \\
&amp;= \sqrt{1-\phi^{-1}} \\
&amp;= |\rho|
\end{align*}
\]</span> となることが確認できる。</p>
<p>また<span class="math inline">\(m\)</span>個の確率変数の組<span
class="math inline">\(\mathbf{x} = (x_1, x_2, \cdots,
x_m)\)</span>について、<span class="math inline">\(x_i,
x_j\)</span>に関する一般化相関係数を<span
class="math inline">\(|r|_{ij}\)</span>と表記することにする。このとき
<strong>一般化絶対相関行列（generalized absolute correlation
matrix）</strong> または <strong>一般化相関行列</strong> を <span
class="math display">\[
(\mathbf{A})_{ij} = |r|_{ij}
\]</span> なる<span
class="math inline">\(m\)</span>次元正方行列と定義する。定義より対角成分は<span
class="math inline">\((\mathbf{A})_{ii} =
1\)</span>であり、また対称行列である。<span
class="math inline">\(\mathbf{x}\)</span>が多変量正規分布に従うとき、通常の相関行列の成分を絶対値に置き換えたものと一致する。</p>
<p>逆に<span
class="math inline">\(|r|_{ij}\)</span>の値を相関係数とみなして多変量正規分布を定義することができる。すなわち<span
class="math inline">\(\mathbf{A}\)</span>を与えれば、これを相関行列とみなして<span
class="math inline">\(m\)</span>変量正規分布を定めることができる。このことからもわかるように、<span
class="math inline">\(\mathbf{A}\)</span>は半正定値対称行列である。</p>
<h1 id="データ解析における利用">データ解析における利用</h1>
<p>これらを実際のデータ解析において利用するにあたっては、何らかの方法で<span
class="math inline">\(\phi\)</span>を推定できればよい。これについては[1]で推定手法の開発を進めており、本稿で定義した指標についても適用できるものと考えられる。</p>
<p><strong>基準化正弦距離行列</strong>
はクラスター分析や多次元尺度法に利用できる。ここで定めた手法が三角不等式を含む距離の公理を満たすことによって、一般の非類似度を用いるよりも望ましい性質をもつことが期待できる。</p>
<p><strong>一般化相関行列</strong>
は探索的データ解析の手法として利用することができ、データ全体の傾向をすみやかに概観することができる。形式的には主成分分析や因子分析にも応用することができ、データの背後にある構造を探るうえで有用である可能性がある。</p>
<h1 id="結論および今後の方針">結論および今後の方針</h1>
<p>[1]において開発中の推定手法を適用し、数値シミュレーションや実際のデータ解析の例を用いてその有用性を評価することを予定している。</p>
<h1 id="補遺">補遺</h1>
<h2 id="角度の定義に関する議論">角度の定義に関する議論</h2>
<p>議論の過程で試みた、<span
class="math inline">\(L^2\)</span>空間における内積に基づく角度の定義について振り返る。離散確率変数の場合、これは以下のようなものだった：
<span class="math display">\[
\begin{align*}
\cos \theta^* &amp;= \frac{\langle q, r\rangle}{\|q\|\|r\|}\\
&amp;= \frac{\phi}{\sqrt{k_x k_y}}
\end{align*}
\]</span> これは<span class="math inline">\(k = k_x =
k_y\)</span>であれば<span class="math inline">\([1/k,
1]\)</span>に値をとり、その意味で提案手法における基準化前の角度と類似した特徴を持つ。また分母が<span
class="math inline">\(\min\{k_x, k_y\}\)</span>ではなく<span
class="math inline">\(\sqrt{k_x
k_y}\)</span>という形になっている点も数学的に自然なようにも思われる。</p>
<p>ただし以下のように考えると、基準化において<span
class="math inline">\(k = \min\{k_x,
k_y\}\)</span>を用いたことが適切であることがわかる。もし<span
class="math inline">\(k&#39; = \sqrt{k_x k_y}\)</span>とすると、<span
class="math inline">\(\phi &gt;
k&#39;\)</span>となる場合が生じ得る。この場合、<span
class="math inline">\(\cos \theta^*\)</span>が<span
class="math inline">\(1\)</span>を超える場合が出てきてしまい、<span
class="math inline">\(0 \leq \theta^* \leq
\pi/2\)</span>の条件が満たされなくなる。</p>
<p>これは角度の定義としては問題なく、興味深い解釈が可能と思われる。一方で<span
class="math inline">\(\pi/2\)</span>に対する余角の議論や相関係数の絶対値との関係など、<span
class="math inline">\(\theta\)</span>が<span class="math inline">\([0,
\pi/2]\)</span>の範囲にあることで得られる望ましい性質が失われるものと考えられる。</p>
<p>以上のことから、<span
class="math inline">\(L^2\)</span>空間における議論は動機付けとしては役立ったものの、指標の定義としては提案手法の通りとした。</p>
<h1 id="参考文献">参考文献</h1>
<p>[1] R. Suzuki (2025). A generalization of correlation coefficient.
preprint. <a href="https://r-suzuki.github.io/preprints"
class="uri">https://r-suzuki.github.io/preprints</a>.</p>
<p>[2] Han, J., Kamber, M., &amp; Pei, J. (2011). Data mining: Concepts
and Techniques (3rd ed.). Morgan Kaufmann Publishers.</p>
<p>[3] Bhattacharyya, A. (1943). On a Measure of Divergence Between Two
Statistical Populations Defined by Their Probability Distributions.
Bulletin of the Calcutta Mathematical Society, 35, 99–109.</p>
</body>
</html>
